{% load static %}
{% load i18n %}  <!-- Cargar la librería i18n -->
<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport"/>
        <link rel="icon" href="{% static 'assets/img/logos/logo-white.png' %}" type="image/x-icon"/>

        <!-- Fonts and icons -->
        <script src="{% static 'assets/js/plugin/webfont/webfont.min.js' %}"></script>
        <!-- <script>
            WebFont.load({
                google: { families: ["Public Sans:300,400,500,600,700"] },
                custom: {
                    families: [
                        "Font Awesome 5 Solid",
                        "Font Awesome 5 Regular",
                        "Font Awesome 5 Brands",
                        "simple-line-icons",
                    ],
                    urls: ["{% static 'assets/css/core/fonts.min.css' %}"],
                },
                active: function () {
                    sessionStorage.fonts = true;
                },
            });
        </script> -->
        
        <!-- Material Icons -->
        <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
        
        <!-- Boostrap 5.3.3 (SOLO UNA VEZ) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
        <!-- Select 2 (SOLO UNA VEZ) -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
        
        <!-- CSS Files -->
        <link id="theme-style" rel="stylesheet" href="{% static 'assets/css/light-theme.css' %}" />
        <!-- <link rel="stylesheet" href="{% static 'assets/css/core/plugins.min.css' %}" /> -->
        <!-- <link rel="stylesheet" href="{% static 'assets/css/demo.css' %}" /> -->
        <link rel="stylesheet" href="{% static 'assets/css/components/theme_switch.css' %}" />
        <!-- <link rel="stylesheet" href="{% static 'assets/css/components/chatbot.css' %}" /> -->
        <!-- {% include 'components/css.html' %} -->
        <style>
            .brand-logo img {
                max-width: 100%;
                max-height: 100%;
                width: auto;
                height: auto;
                padding-top: 20px;
            }
            .loading-modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1050;
                justify-content: center;
                align-items: center;
            }
            .loading-content {
                background: white;
                padding: 20px;
                border-radius: 8px;
                text-align: center;
            }
            .spinner-border {
                width: 3rem;
                height: 3rem;
            }
            /* Estilos para el switch */
            .switch {
                position: relative;
                display: inline-block;
                width: 60px;
                height: 34px;
            }

            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }

            .slider {
                position: absolute;
                cursor: pointer;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #ccc;
                transition: 0.4s;
            }

            .slider.round {
                border-radius: 34px;
            }

            .slider:before {
                position: absolute;
                content: "";
                height: 26px;
                width: 26px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                transition: 0.4s;
                border-radius: 50%;
            }

            input:checked + .slider {
                background-color: #2196F3;
            }

            input:checked + .slider:before {
                transform: translateX(26px);
            }

            .theme-label {
                margin-left: 10px;
                font-size: 16px;
            }

            /* Estilos para los iconos */
            .theme-label i {
                font-size: 20px;
                transition: opacity 0.3s ease;
            }

            .theme-label .fa-sun {
                color: #ffc107; /* Color amarillo para el sol */
            }

            .theme-label .fa-moon {
                color: #333; /* Color oscuro para la luna */
            }

            /* Ocultar el icono de la luna por defecto */
            .theme-label .fa-moon {
                display: none;
            }

            /* Mostrar el icono de la luna en tema oscuro */
            body.dark-theme .theme-label .fa-sun {
                display: none;
            }

            body.dark-theme .theme-label .fa-moon {
                display: inline-block;
            }
        </style>
        <!-- Page specific CSS -->
        {% block stylesheets %}{% endblock stylesheets %}
    </head>
    <body class="light-theme">
        <div class="wrapper">
            <!-- Sidebar -->
            <div class="sidebar" data-background-color="dark">
                {% include 'components/sidebar.html' %}
            </div>
            <!-- End Sidebar -->
            <div class="main-panel">
                <!-- Header con selector de tema e idioma -->
                <div class="header">
                    {% include 'components/header.html' %}                    
                </div>
                <!-- Contenido -->
                <div class="container">
                    {% block content %}{% endblock %}
                </div>
                {% include 'components/custom.html'%}
                <!-- Inicio Modal -->
                {% include 'components/modal.html' %}
                <!-- Fin Modal -->
                <!-- End Contenido -->
                {% include 'components/footer.html' %}
                {% include 'components/chatbot.html' %}
            </div>
        </div>
        
        <!-- jQuery (SOLO UNA VEZ - versión completa) -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        
        <!-- Bootstrap JS (SOLO UNA VEZ) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        
        <!-- Select2 (SOLO UNA VEZ) -->
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        

        <script type="text/javascript">
            $('.select2').select2({
                theme: "bootstrap-5",
                language: "es",
                width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
            });
        </script>
        
        <!-- Script para cambiar tema -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const themeToggle = document.getElementById('theme-toggle');
                const body = document.body;
                const themeStyle = document.getElementById('theme-style');

                // Verificar si el usuario ya tiene una preferencia guardada
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark-theme') {
                    body.classList.add('dark-theme');
                    themeStyle.href = "{% static 'assets/css/dark-theme.css' %}";
                }

                // Cambiar tema al hacer clic en el botón
                themeToggle.addEventListener('click', function () {
                    if (body.classList.contains('dark-theme')) {
                        body.classList.remove('dark-theme');
                        themeStyle.href = "{% static 'assets/css/light-theme.css' %}";
                        localStorage.setItem('theme', 'light-theme');
                    } else {
                        body.classList.add('dark-theme');
                        themeStyle.href = "{% static 'assets/css/dark-theme.css' %}";
                        localStorage.setItem('theme', 'dark-theme');
                    }
                });
            });
        </script>

        <!-- Script para cambiar idioma -->
        <script>
            document.getElementById('language-select').addEventListener('change', function () {
                const selectedLanguage = this.value;
                window.location.href = `/i18n/setlang/?language=${selectedLanguage}&next=${window.location.pathname}`;
            });
        </script>

        <!-- Scripts adicionales -->
        {% include 'components/scripts.html' %}
        
        <!-- Page specific Scripts -->
        {% block javascripts %}{% endblock javascripts %}
    </body>
</html>